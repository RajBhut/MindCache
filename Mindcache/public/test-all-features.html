<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MindCache - Complete Feature Test</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
      }

      .content {
        padding: 40px;
      }

      .feature-section {
        margin-bottom: 40px;
        padding: 30px;
        background: #f8fafc;
        border-radius: 12px;
        border-left: 5px solid #667eea;
      }

      .feature-section h2 {
        color: #2d3748;
        margin-bottom: 20px;
        font-size: 1.8rem;
      }

      .feature-section h3 {
        color: #4a5568;
        margin: 20px 0 10px 0;
        font-size: 1.3rem;
      }

      .test-text {
        background: #ffffff;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
        border: 2px dashed #e2e8f0;
        cursor: text;
        user-select: text;
        line-height: 1.8;
      }

      .test-text:hover {
        border-color: #667eea;
        background: #f7fafc;
      }

      .instruction {
        background: #bee3f8;
        border: 1px solid #90cdf4;
        padding: 15px;
        border-radius: 8px;
        margin: 15px 0;
        color: #2b6cb0;
      }

      .instruction strong {
        color: #1a365d;
      }

      .test-buttons {
        display: flex;
        gap: 15px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .test-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.2s ease;
        font-size: 14px;
      }

      .test-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      }

      .test-btn:active {
        transform: translateY(0);
      }

      .status-indicator {
        position: fixed;
        top: 20px;
        left: 20px;
        background: #48bb78;
        color: white;
        padding: 10px 20px;
        border-radius: 25px;
        font-weight: 500;
        z-index: 10000;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      }

      .checklist {
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        border: 1px solid #e2e8f0;
      }

      .checklist-item {
        display: flex;
        align-items: center;
        margin: 10px 0;
        padding: 8px;
        border-radius: 6px;
        transition: background 0.2s ease;
      }

      .checklist-item:hover {
        background: #f7fafc;
      }

      .checklist-item input[type="checkbox"] {
        margin-right: 12px;
        transform: scale(1.2);
        accent-color: #667eea;
      }

      .highlight-demo {
        background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
        padding: 15px;
        border-radius: 8px;
        margin: 15px 0;
        border-left: 5px solid #fdcb6e;
      }

      .focus-demo {
        background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
        color: white;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
      }

      .data-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      .data-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        border: 2px solid #e2e8f0;
        transition: all 0.2s ease;
      }

      .data-card:hover {
        border-color: #667eea;
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .data-card-icon {
        font-size: 2.5rem;
        margin-bottom: 10px;
      }

      .data-card-count {
        font-size: 2rem;
        font-weight: bold;
        color: #2d3748;
        margin-bottom: 5px;
      }

      .data-card-label {
        color: #718096;
        font-weight: 500;
        text-transform: uppercase;
        font-size: 0.8rem;
      }

      .keyboard-shortcuts {
        background: #2d3748;
        color: white;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
      }

      .shortcut-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 8px 0;
        padding: 5px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .shortcut-key {
        background: rgba(255, 255, 255, 0.1);
        padding: 4px 8px;
        border-radius: 4px;
        font-family: monospace;
        font-size: 0.9rem;
      }

      @media (max-width: 768px) {
        .container {
          margin: 10px;
        }

        .content {
          padding: 20px;
        }

        .test-buttons {
          flex-direction: column;
        }

        .data-summary {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="status-indicator">üß† MindCache Test Page - Extension Ready</div>

    <div class="container">
      <div class="header">
        <h1>üß† MindCache Extension</h1>
        <p>Complete Feature Test & Demonstration</p>
      </div>

      <div class="content">
        <!-- Selection Toolbar Test -->
        <div class="feature-section">
          <h2>üìù Selection Toolbar Test</h2>
          <div class="instruction">
            <strong>Instructions:</strong> Select any text below to see the
            enhanced toolbar with 6 actions: Save Quote, Add Note, Highlight,
            Copy, Search, and AI Insights.
          </div>

          <div class="test-text">
            This is a sample text for testing the selection toolbar
            functionality. You can select any part of this text to see the
            MindCache toolbar appear with multiple action buttons. The toolbar
            should be beautiful, animated, and fully functional with proper
            positioning.
          </div>

          <div class="test-text">
            "The future belongs to those who learn more skills and combine them
            in creative ways." - Robert Greene. This quote is perfect for
            testing the quote saving functionality of MindCache.
          </div>

          <div class="test-text">
            Web browsers have revolutionized how we access information. From
            simple text-based browsers like Lynx to modern feature-rich
            applications like Chrome, Firefox, and Safari, the evolution has
            been remarkable. Today's browsers support complex JavaScript
            applications, advanced CSS styling, and sophisticated user
            interactions.
          </div>

          <div class="checklist">
            <div class="checklist-item">
              <input type="checkbox" id="toolbar-appears" />
              <label for="toolbar-appears"
                >Selection toolbar appears when selecting text</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="toolbar-buttons" />
              <label for="toolbar-buttons"
                >All 6 buttons are visible (üíæüìùüñçÔ∏èüìãüîçüß†)</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="toolbar-animation" />
              <label for="toolbar-animation"
                >Toolbar has smooth animations</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="toolbar-positioning" />
              <label for="toolbar-positioning"
                >Toolbar positions correctly above/below selection</label
              >
            </div>
          </div>
        </div>

        <!-- Persistent Highlighting Test -->
        <div class="feature-section">
          <h2>üñçÔ∏è Persistent Highlighting Test</h2>
          <div class="instruction">
            <strong>Instructions:</strong> Select text below and click the
            highlight button (üñçÔ∏è). Then refresh the page to verify highlights
            persist.
          </div>

          <div class="test-text">
            This paragraph is specifically designed for testing persistent
            highlighting. Select this sentence and highlight it, then refresh
            the page to see if the highlight remains. The highlighting should
            survive page reloads and browser restarts.
          </div>

          <div class="highlight-demo">
            <strong>Already Highlighted Sample:</strong> This text demonstrates
            how highlights should look with the yellow background and proper
            styling.
          </div>

          <div class="test-buttons">
            <button class="test-btn" onclick="testHighlightPersistence()">
              üîÑ Test Highlight Persistence
            </button>
            <button class="test-btn" onclick="clearPageHighlights()">
              üóëÔ∏è Clear Page Highlights
            </button>
          </div>

          <div class="checklist">
            <div class="checklist-item">
              <input type="checkbox" id="highlight-works" />
              <label for="highlight-works"
                >Text can be highlighted with yellow background</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="highlight-persists" />
              <label for="highlight-persists"
                >Highlights remain after page refresh</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="highlight-restoration" />
              <label for="highlight-restoration"
                >Highlights are automatically restored on page load</label
              >
            </div>
          </div>
        </div>

        <!-- Enhanced Focus Mode Test -->
        <div class="feature-section">
          <h2>üéØ Enhanced Focus Mode Test</h2>
          <div class="instruction">
            <strong>Instructions:</strong> Click the focus button (üéØ) in the
            top-right corner or press <kbd>Ctrl+Shift+F</kbd> to activate
            enhanced focus mode. Press <kbd>ESC</kbd> to exit.
          </div>

          <div class="focus-demo">
            <h3>Focus Mode Features:</h3>
            <ul>
              <li>‚ú® Dark theme with improved readability</li>
              <li>üìñ Reading progress indicator at the top</li>
              <li>üéØ Highlighted text glows with special effects</li>
              <li>üåü Hover effects on paragraphs and headings</li>
              <li>üö´ Distracting elements are dimmed or hidden</li>
              <li>‚å®Ô∏è Keyboard shortcuts for easy access</li>
            </ul>
          </div>

          <div class="test-text">
            When focus mode is active, this text should be more readable with
            the enhanced styling. The page background changes to dark,
            distracting elements are dimmed, and the main content becomes more
            prominent. Try hovering over paragraphs to see the interactive
            effects.
          </div>

          <div class="keyboard-shortcuts">
            <h3>Keyboard Shortcuts:</h3>
            <div class="shortcut-item">
              <span>Toggle Focus Mode</span>
              <span class="shortcut-key">Ctrl + Shift + F</span>
            </div>
            <div class="shortcut-item">
              <span>Exit Focus Mode</span>
              <span class="shortcut-key">ESC</span>
            </div>
          </div>

          <div class="checklist">
            <div class="checklist-item">
              <input type="checkbox" id="focus-activates" />
              <label for="focus-activates"
                >Focus mode activates with button or keyboard shortcut</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="focus-progress" />
              <label for="focus-progress"
                >Reading progress bar appears at top</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="focus-styling" />
              <label for="focus-styling"
                >Dark theme and enhanced styling applied</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="focus-deactivates" />
              <label for="focus-deactivates"
                >Focus mode deactivates with ESC key</label
              >
            </div>
          </div>
        </div>

        <!-- Extension Popup Test -->
        <div class="feature-section">
          <h2>üìä Extension Popup Test</h2>
          <div class="instruction">
            <strong>Instructions:</strong> Click the MindCache extension icon in
            your browser toolbar to open the popup with tabs for Overview,
            Highlights, Notes, and Quotes.
          </div>

          <div class="data-summary">
            <div class="data-card">
              <div class="data-card-icon">üñçÔ∏è</div>
              <div class="data-card-count" id="highlight-count">0</div>
              <div class="data-card-label">Highlights</div>
            </div>
            <div class="data-card">
              <div class="data-card-icon">üí≠</div>
              <div class="data-card-count" id="note-count">0</div>
              <div class="data-card-label">Notes</div>
            </div>
            <div class="data-card">
              <div class="data-card-icon">üíæ</div>
              <div class="data-card-count" id="quote-count">0</div>
              <div class="data-card-label">Quotes</div>
            </div>
            <div class="data-card">
              <div class="data-card-icon">üåê</div>
              <div class="data-card-count" id="site-count">1</div>
              <div class="data-card-label">Sites</div>
            </div>
          </div>

          <div class="test-buttons">
            <button class="test-btn" onclick="updateDataSummary()">
              üîÑ Refresh Data Summary
            </button>
            <button class="test-btn" onclick="openExtensionPopup()">
              üöÄ Open Extension Popup
            </button>
          </div>

          <div class="checklist">
            <div class="checklist-item">
              <input type="checkbox" id="popup-opens" />
              <label for="popup-opens"
                >Extension popup opens when clicking icon</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="popup-tabs" />
              <label for="popup-tabs"
                >All 4 tabs are visible and functional</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="popup-data" />
              <label for="popup-data"
                >Current site data is displayed correctly</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="popup-actions" />
              <label for="popup-actions"
                >Clear and export buttons work properly</label
              >
            </div>
          </div>
        </div>

        <!-- Modal Functionality Test -->
        <div class="feature-section">
          <h2>üîß Modal & Interaction Test</h2>
          <div class="instruction">
            <strong>Instructions:</strong> Click the activity indicator
            (bottom-right) to test the improved modal with working buttons and
            proper close functionality.
          </div>

          <div class="test-text">
            The site activity tracker shows a modal when clicked. This modal
            should have properly working clear buttons for highlights, notes,
            and quotes, as well as an export function. Most importantly, the
            modal should have multiple ways to close: X button, ESC key, and
            clicking outside.
          </div>

          <div class="test-buttons">
            <button class="test-btn" onclick="testModalFunctionality()">
              üß™ Test Modal Functions
            </button>
            <button class="test-btn" onclick="simulateDataEntry()">
              üìä Simulate Data Entry
            </button>
            <button class="test-btn" onclick="testExportFeature()">
              üì§ Test Export Feature
            </button>
          </div>

          <div class="checklist">
            <div class="checklist-item">
              <input type="checkbox" id="modal-opens" />
              <label for="modal-opens"
                >Activity modal opens when clicking indicator</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="modal-buttons" />
              <label for="modal-buttons"
                >All clear and export buttons work</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="modal-close" />
              <label for="modal-close"
                >Modal closes with X, ESC, or outside click</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="modal-animations" />
              <label for="modal-animations"
                >Modal has smooth open/close animations</label
              >
            </div>
          </div>
        </div>

        <!-- Enhanced Note Dialog Test -->
        <div class="feature-section">
          <h2>üí≠ Enhanced Note Dialog Test</h2>
          <div class="instruction">
            <strong>Instructions:</strong> Select text and click the note button
            (üí≠) to test the beautiful enhanced note dialog with character
            counter and metadata.
          </div>

          <div class="test-text">
            This text is perfect for testing the enhanced note dialog. Select
            this sentence and add a note to see the improved interface with
            character counting, metadata display, and beautiful styling. The
            dialog should show the selected text, current site information, and
            provide a rich text input experience.
          </div>

          <div class="checklist">
            <div class="checklist-item">
              <input type="checkbox" id="note-dialog" />
              <label for="note-dialog"
                >Enhanced note dialog opens with proper styling</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="note-character-count" />
              <label for="note-character-count"
                >Character counter works and shows limits</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="note-metadata" />
              <label for="note-metadata"
                >Site metadata and selected text are displayed</label
              >
            </div>
            <div class="checklist-item">
              <input type="checkbox" id="note-saves" />
              <label for="note-saves"
                >Notes save successfully with confirmation</label
              >
            </div>
          </div>
        </div>

        <!-- Final Status -->
        <div class="feature-section">
          <h2>‚úÖ Test Results Summary</h2>
          <div id="test-summary">
            <p>Complete the tests above to see your results summary here.</p>
          </div>

          <div class="test-buttons">
            <button class="test-btn" onclick="generateTestReport()">
              üìã Generate Test Report
            </button>
            <button class="test-btn" onclick="resetAllTests()">
              üîÑ Reset All Tests
            </button>
            <button class="test-btn" onclick="exportTestData()">
              üì§ Export Test Data
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Test functionality
      function updateDataSummary() {
        try {
          const highlights = JSON.parse(
            localStorage.getItem("mindcache-highlights") || "[]"
          );
          const notes = JSON.parse(
            localStorage.getItem("mindcache-notes") || "[]"
          );
          const quotes = JSON.parse(
            localStorage.getItem("mindcache-quotes") || "[]"
          );

          const domain = window.location.hostname;
          const domainHighlights = highlights.filter(
            (h) => h.domain === domain
          );
          const domainNotes = notes.filter((n) => n.domain === domain);
          const domainQuotes = quotes.filter((q) => q.domain === domain);

          document.getElementById("highlight-count").textContent =
            domainHighlights.length;
          document.getElementById("note-count").textContent =
            domainNotes.length;
          document.getElementById("quote-count").textContent =
            domainQuotes.length;

          console.log("Data summary updated");
        } catch (error) {
          console.error("Error updating data summary:", error);
        }
      }

      function testHighlightPersistence() {
        const highlights = JSON.parse(
          localStorage.getItem("mindcache-highlights") || "[]"
        );
        alert(
          `Found ${highlights.length} total highlights in storage. Refresh the page to test persistence.`
        );
      }

      function clearPageHighlights() {
        if (confirm("Clear all highlights from this page?")) {
          document
            .querySelectorAll(".mindcache-highlighted-text")
            .forEach((el) => {
              el.outerHTML = el.textContent;
            });

          const highlights = JSON.parse(
            localStorage.getItem("mindcache-highlights") || "[]"
          );
          const filteredHighlights = highlights.filter(
            (h) => h.url !== window.location.href
          );
          localStorage.setItem(
            "mindcache-highlights",
            JSON.stringify(filteredHighlights)
          );

          alert("Page highlights cleared!");
          updateDataSummary();
        }
      }

      function testModalFunctionality() {
        if (window.MindCacheSiteTracker) {
          window.MindCacheSiteTracker.showSiteData();
        } else {
          alert(
            "Site tracker not loaded. Please wait for the extension to fully initialize."
          );
        }
      }

      function simulateDataEntry() {
        // Add some test data
        const testHighlight = {
          id: Date.now().toString(36),
          text: "Test highlight for demonstration",
          url: window.location.href,
          domain: window.location.hostname,
          title: document.title,
          timestamp: new Date().toISOString(),
        };

        const highlights = JSON.parse(
          localStorage.getItem("mindcache-highlights") || "[]"
        );
        highlights.push(testHighlight);
        localStorage.setItem(
          "mindcache-highlights",
          JSON.stringify(highlights)
        );

        updateDataSummary();
        alert("Test data added! Check the data summary and extension popup.");
      }

      function testExportFeature() {
        const testData = {
          domain: window.location.hostname,
          timestamp: new Date().toISOString(),
          highlights: JSON.parse(
            localStorage.getItem("mindcache-highlights") || "[]"
          ),
          notes: JSON.parse(localStorage.getItem("mindcache-notes") || "[]"),
          quotes: JSON.parse(localStorage.getItem("mindcache-quotes") || "[]"),
        };

        const blob = new Blob([JSON.stringify(testData, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `mindcache-test-export-${
          new Date().toISOString().split("T")[0]
        }.json`;
        a.click();
        URL.revokeObjectURL(url);

        alert("Test export completed!");
      }

      function openExtensionPopup() {
        alert(
          "Click the MindCache extension icon in your browser toolbar to open the popup with tabs."
        );
      }

      function generateTestReport() {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const total = checkboxes.length;
        const checked = Array.from(checkboxes).filter(
          (cb) => cb.checked
        ).length;
        const percentage = Math.round((checked / total) * 100);

        const report = `
                Test Results Summary:
                ‚úÖ Completed: ${checked}/${total} tests (${percentage}%)
                
                ${
                  checked === total
                    ? "üéâ All tests passed! MindCache is working perfectly."
                    : checked > total * 0.8
                    ? "üëç Most tests passed! Minor issues may exist."
                    : checked > total * 0.5
                    ? "‚ö†Ô∏è Some issues detected. Check failed tests."
                    : "‚ùå Major issues detected. Extension may need troubleshooting."
                }
                  
                Generated: ${new Date().toLocaleString()}
            `;

        document.getElementById(
          "test-summary"
        ).innerHTML = `<pre style="background: #f8fafc; padding: 15px; border-radius: 8px; white-space: pre-wrap;">${report}</pre>`;
      }

      function resetAllTests() {
        if (confirm("Reset all test checkboxes?")) {
          document
            .querySelectorAll('input[type="checkbox"]')
            .forEach((cb) => (cb.checked = false));
          document.getElementById("test-summary").innerHTML =
            "<p>Complete the tests above to see your results summary here.</p>";
        }
      }

      function exportTestData() {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const testResults = Array.from(checkboxes).map((cb) => ({
          test: cb.nextElementSibling.textContent,
          passed: cb.checked,
          id: cb.id,
        }));

        const exportData = {
          testSession: {
            url: window.location.href,
            timestamp: new Date().toISOString(),
            userAgent: navigator.userAgent,
            results: testResults,
          },
          mindcacheData: {
            highlights: JSON.parse(
              localStorage.getItem("mindcache-highlights") || "[]"
            ),
            notes: JSON.parse(localStorage.getItem("mindcache-notes") || "[]"),
            quotes: JSON.parse(
              localStorage.getItem("mindcache-quotes") || "[]"
            ),
          },
        };

        const blob = new Blob([JSON.stringify(exportData, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `mindcache-test-results-${
          new Date().toISOString().split("T")[0]
        }.json`;
        a.click();
        URL.revokeObjectURL(url);
      }

      // Initialize
      document.addEventListener("DOMContentLoaded", () => {
        updateDataSummary();

        // Update data every few seconds
        setInterval(updateDataSummary, 3000);

        // Auto-generate report when checkboxes change
        document.addEventListener("change", (e) => {
          if (e.target.type === "checkbox") {
            setTimeout(generateTestReport, 100);
          }
        });
      });
    </script>
  </body>
</html>
